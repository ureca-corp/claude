# Ubiquitous Language 템플릿

## 유비쿼터스 언어 명세 구조

### 전체 구조

```markdown
# {domain} 도메인 모델

> 생성일: {날짜}
> Phase: 3 (Domain Modeler)
> 상태: ✅ 완료

---

## 📖 유비쿼터스 언어 (용어 정의)

> 이 도메인에서 사용하는 전용 용어들

### 핵심 용어

| 용어 | 정의 | 예시 |
|------|------|------|
| ... | ... | ... |

---

## 📐 관계 규칙

> 이 도메인의 엔티티들이 어떻게 연결되는지 서술형으로 정의

### {엔티티A}와 {엔티티B}

**규칙 1**: ...
**규칙 2**: ...

---

## ✅ 제약 조건

> 엔티티가 지켜야 하는 규칙

### 필수 규칙

1. **{필드}**는 ...
2. **{필드}**는 ...

---

## 🔄 생명주기

> 엔티티가 어떻게 생성, 수정, 삭제되는지

### 생성

\`\`\`
...
\`\`\`

### 수정

\`\`\`
...
\`\`\`

### 삭제

\`\`\`
...
\`\`\`
```

---

## 용어 정의 테이블

### 템플릿

```markdown
| 용어 | 정의 | 예시 |
|------|------|------|
| {한글명 (English)} | {이 용어가 무엇인지 설명} | {실제 사용 예시} |
```

### 예시

```markdown
| 용어 | 정의 | 예시 |
|------|------|------|
| 사용자 (User) | 앱을 사용하는 개인 | "홍길동", "john@example.com" |
| 식별자 (ID) | 사용자를 고유하게 구분하는 값 | "u_123abc" |
| 이메일 (Email) | 로그인 및 연락용 이메일 주소 | "user@example.com" |
| 표시 이름 (DisplayName) | 다른 사용자에게 보이는 이름 | "여행러버", "TravelLover" |
| 프로필 사진 (ProfileImage) | 사용자의 프로필 이미지 URL | "https://.../profile.jpg" |
| 선호 언어 (PreferredLanguage) | 사용자가 선호하는 언어 설정 | "한국어", "영어" |
| 가입 시각 (CreatedAt) | 사용자가 가입한 날짜와 시간 | "2026-01-28 10:30:00" |
```

---

## 관계 규칙

### 1:N 관계 템플릿

```markdown
### {엔티티A}와 {엔티티B}

**규칙 1**: {A}는 여러 개의 {B}를 가질 수 있다.
- {A}가 0개 이상의 {B}를 가질 수 있는 이유
- 예: "{A} 사용자는 10개의 {B}를 가지고 있다"

**규칙 2**: {B}는 반드시 한 개의 {A}에 속한다.
- 모든 {B}는 소유자 {A}가 있어야 함
- 예: "이 {B}는 john@example.com {A}의 것이다"

**규칙 3**: {A}가 삭제되면 모든 {B}도 함께 삭제된다.
- {A} 삭제 시 Cascade 정책
- 예: "{A}가 탈퇴하면 그의 {B} 10개도 모두 삭제된다"
```

### 예시 (users - translations)

```markdown
### 사용자와 번역 기록

**규칙 1**: 사용자는 여러 개의 번역 기록을 가질 수 있다.
- 한 사용자가 0개 이상의 번역을 요청할 수 있음
- 예: "홍길동 사용자는 10개의 번역 기록을 가지고 있다"

**규칙 2**: 번역 기록은 반드시 한 명의 사용자에게 속한다.
- 모든 번역은 누가 요청했는지 기록됨
- 예: "이 번역 기록은 john@example.com 사용자의 것이다"

**규칙 3**: 사용자가 삭제되면 모든 번역 기록도 함께 삭제된다.
- 사용자 탈퇴 시 개인정보 보호를 위해 모든 데이터 삭제
- 예: "홍길동 사용자가 탈퇴하면 그의 번역 기록 10개도 모두 삭제된다"
```

---

### 1:1 관계 템플릿

```markdown
### {엔티티A}와 {엔티티B}

**규칙 1**: {A}는 하나의 {B}를 가진다.
- {A}와 {B}가 일대일로 대응
- 예: "{A}는 하나의 {B}를 가진다"

**규칙 2**: {B}는 반드시 하나의 {A}에 속한다.
- 모든 {B}는 정확히 하나의 {A}와 연결
- 예: "이 {B}는 {A}에 속한다"
```

---

### N:M 관계 템플릿

```markdown
### {엔티티A}와 {엔티티B}

**규칙 1**: {A}는 여러 개의 {B}와 연결될 수 있다.
- {A}가 여러 {B}를 가질 수 있음
- 예: "{A}는 5개의 {B}와 연결되어 있다"

**규칙 2**: {B}는 여러 개의 {A}와 연결될 수 있다.
- {B}도 여러 {A}를 가질 수 있음
- 예: "이 {B}는 3개의 {A}와 연결되어 있다"
```

---

## 제약 조건

### 템플릿

```markdown
1. **{필드명}**은 {제약 내용}.
   - {이유}
   - 예: {구체적 예시}
```

### 예시

```markdown
1. **식별자 (ID)**는 시스템이 자동으로 생성한다.
   - 사용자가 직접 설정할 수 없음

2. **이메일 (Email)**은 중복될 수 없다.
   - 이미 존재하는 이메일로는 가입 불가
   - 예: "user@example.com"으로 이미 가입되어 있으면 다시 가입 불가

3. **이메일 (Email)**은 반드시 유효한 형식이어야 한다.
   - "@" 기호 포함
   - 예: "user@example.com" (올바름), "userexample.com" (잘못됨)

4. **표시 이름 (DisplayName)**은 비어있을 수 없다.
   - 최소 1자 이상

5. **선호 언어 (PreferredLanguage)**는 '한국어' 또는 '영어'만 가능하다.
   - 다른 언어는 MVP에서 지원하지 않음

6. **프로필 사진 (ProfileImage)**은 선택 사항이다.
   - 없어도 가입 가능
```

---

## 생명주기

### 생성 템플릿

```markdown
### 생성 ({액션명})

\`\`\`
{주체}가 {액션}을 요청한다
    ↓
{검증 1}을 확인한다
    ↓
{검증 2}를 확인한다
    ↓
{엔티티}를 생성한다
    ↓
{자동 설정 필드}를 자동으로 설정한다
\`\`\`

**규칙**: {기본값이나 특별한 처리 규칙}
```

### 생성 예시

```markdown
### 생성 (가입)

\`\`\`
사용자가 가입을 요청한다
    ↓
이메일이 중복되지 않는지 확인한다
    ↓
모든 필수 정보가 제공되었는지 확인한다
    ↓
사용자 엔티티를 생성한다
    ↓
식별자(ID)와 가입 시각(CreatedAt)을 자동으로 설정한다
\`\`\`

**규칙**: 가입 시 선호 언어가 제공되지 않으면 기본값은 '영어'로 설정된다.
```

---

### 수정 템플릿

```markdown
### 수정 ({액션명})

\`\`\`
{주체}가 {액션}을 요청한다
    ↓
{권한}을 확인한다 (권한 검사)
    ↓
수정 가능한 필드만 변경한다
\`\`\`

**수정 가능한 필드**:
- {필드 1}
- {필드 2}

**수정 불가능한 필드**:
- {필드 A}
- {필드 B}

**규칙**: {권한이나 특별한 규칙}
```

### 수정 예시

```markdown
### 수정 (프로필 편집)

\`\`\`
사용자가 프로필 수정을 요청한다
    ↓
본인인지 확인한다 (권한 검사)
    ↓
수정 가능한 필드만 변경한다
\`\`\`

**수정 가능한 필드**:
- 표시 이름 (DisplayName)
- 프로필 사진 (ProfileImage)
- 선호 언어 (PreferredLanguage)

**수정 불가능한 필드**:
- 식별자 (ID)
- 이메일 (Email)
- 가입 시각 (CreatedAt)

**규칙**: 본인만 자신의 프로필을 수정할 수 있다.
```

---

### 삭제 템플릿

```markdown
### 삭제 ({액션명})

\`\`\`
{주체}가 {액션}을 요청한다
    ↓
{권한}을 확인한다
    ↓
연결된 모든 데이터를 확인한다
    ↓
{연결 데이터 1}, {연결 데이터 2} 등 모두 삭제한다
    ↓
{엔티티}를 삭제한다
\`\`\`

**규칙**: {삭제 정책 - 즉시/복구 가능/익명화 등}
```

### 삭제 예시

```markdown
### 삭제 (탈퇴)

\`\`\`
사용자가 탈퇴를 요청한다
    ↓
본인인지 확인한다
    ↓
연결된 모든 데이터를 확인한다
    ↓
번역 기록, 미션 진행 기록 등 모두 삭제한다
    ↓
사용자 엔티티를 삭제한다
\`\`\`

**규칙**: 탈퇴는 즉시 실행되며, 복구 불가능하다.
```

---

## 작성 원칙

### ✅ 좋은 명세

- "사용자는 여러 개의 번역 기록을 가질 수 있다."
- "번역 기록은 반드시 한 명의 사용자에게 속한다."
- "이메일은 중복될 수 없다."
- "식별자는 시스템이 자동으로 생성한다."

### ❌ 나쁜 명세

- "User 테이블의 id 컬럼은 UUID 타입"
- "Translation.user_id는 User.id를 참조하는 Foreign Key"
- "email 컬럼에 UNIQUE 제약"
- "AUTO_INCREMENT PRIMARY KEY"

→ **말로 설명하기!** 테이블/컬럼 언급 금지.

---

## 금지 용어

**기술 용어 (절대 사용 금지)**:
- 테이블, 컬럼, 필드 (DB 용어)
- Foreign Key, Primary Key, Index
- UUID, VARCHAR, INT, TIMESTAMP
- AUTO_INCREMENT, SERIAL
- CASCADE, ON DELETE, ON UPDATE
- UNIQUE, NOT NULL, DEFAULT
- FastAPI, SQLAlchemy, Pydantic
- HTTP, REST, JSON, API

**대신 사용**:
- "엔티티", "속성", "값"
- "참조한다", "속한다", "연결된다"
- "고유 식별자", "문자열", "숫자", "날짜시간"
- "자동 생성", "순차 번호"
- "함께 삭제된다", "삭제 시"
- "중복될 수 없다", "필수다", "기본값은"
- (프레임워크 언급 안 함)
- (프로토콜 언급 안 함)
