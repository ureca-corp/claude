# maps 도메인 모델

> 생성일: 2026-02-12
> Phase: 3 (Domain Modeler)
> 상태: ✅ 완료

---

## 📖 유비쿼터스 언어 (용어 정의)

> 이 도메인에서 사용하는 전용 용어들

### 핵심 용어

| 용어 | 정의 | 예시 |
|------|------|------|
| 경로 (Route) | 출발지에서 목적지까지의 이동 경로 | A → B 경로 정보 |
| 출발지 (Origin) | 경로의 시작 지점 | "서울역", 현재 위치 |
| 목적지 (Destination) | 경로의 도착 지점 | "명동", "인천공항" |
| 검색 기록 (SearchHistory) | 사용자가 검색한 장소 기록 | "강남역", "홍대입구" |
| 즐겨찾기 (FavoritePlace) | 사용자가 저장한 자주 가는 장소 | "숙소", "회사" |
| 경로 요약 (RouteSummary) | 경로의 시간/거리 요약 정보 | "15분, 3.2km" |

---

## 📐 관계 규칙

> 이 도메인의 엔티티들이 어떻게 연결되는지 서술형으로 정의

### Route와 사용자

**규칙 1**: 경로는 별도 Route 엔티티로 관리된다.
**규칙 2**: Route는 사용자가 직접 소유하지 않지만, Mission을 통해 간접 참조한다.

### Route와 미션

**규칙 3**: 미션(특히 택시)은 Route를 참조할 수 있다.
**규칙 4**: Route는 미션 완료 후에도 기록으로 보관된다.

### SearchHistory와 사용자

**규칙 5**: 검색 기록은 사용자에게 속한다.
**규칙 6**: 한 사용자는 여러 개의 검색 기록을 가질 수 있다.
**규칙 7**: 사용자 탈퇴 시 검색 기록은 완전히 삭제된다.

### FavoritePlace와 사용자

**규칙 8**: 즐겨찾기는 사용자에게 속한다.
**규칙 9**: 한 사용자는 여러 개의 즐겨찾기 장소를 저장할 수 있다.
**규칙 10**: 사용자 탈퇴 시 즐겨찾기는 완전히 삭제된다.

---

## 🔒 제약 조건

> 비즈니스 규칙과 제약사항

### Route 엔티티

**필수 필드**:
- **ID**: 시스템이 자동으로 생성
- **Origin**: 출발지 (텍스트 또는 좌표)
- **Destination**: 목적지 (텍스트 또는 좌표)
- **Summary**: 경로 요약 (시간, 거리)

**선택 필드**:
- **MissionID**: 이 경로가 속한 미션 (선택)

### SearchHistory 엔티티

**필수 필드**:
- **ID**: 시스템이 자동으로 생성
- **UserID**: 검색한 사용자
- **SearchText**: 검색한 장소명
- **CreatedAt**: 검색 시각

**제약**:
**규칙 11**: 최근 10개까지만 보관한다. (오래된 것은 자동 삭제)

### FavoritePlace 엔티티

**필수 필드**:
- **ID**: 시스템이 자동으로 생성
- **UserID**: 즐겨찾기 소유자
- **PlaceName**: 장소 이름
- **Address**: 주소 (또는 좌표)
- **Nickname**: 사용자 지정 별칭 (예: "숙소", "공항")

**제약**:
**규칙 12**: 한 사용자는 최대 20개까지 즐겨찾기를 저장할 수 있다.

### 지도 API 사용

**규칙 13**: 지도 API 호출은 서버 프록시를 통해서만 가능하다. (API 키 보호)
**규칙 14**: 클라이언트는 직접 API를 호출할 수 없다.

---

## 🎯 생명주기

### Route 생성

1. 사용자가 출발지와 목적지를 입력한다.
   - 출발지: 현재 위치 허용 시 자동, 아니면 수동 입력
   - 목적지: 검색 기록, 즐겨찾기, 또는 수동 입력
2. 시스템은 서버 프록시를 통해 네이버 지도 API를 호출한다.
3. API 응답으로 경로 정보를 받는다.
4. Route 엔티티를 생성하고 경로 요약을 저장한다.
5. 사용자에게 경로 카드를 표시한다. (시간/거리)

### Route와 미션 연계

**규칙 15**: 택시 미션에서 경로를 요청하면 MissionID를 함께 저장한다.
**규칙 16**: 가이드 탭에서 "지도로 이동" 버튼을 누르면 미션의 Route를 자동으로 표시한다.

### SearchHistory 생성

1. 사용자가 장소를 검색한다.
2. 검색어를 SearchHistory에 저장한다.
3. 최근 10개를 초과하면 가장 오래된 것을 삭제한다.

### SearchHistory 조회

**규칙 17**: 사용자가 목적지 입력 필드를 누르면 최근 검색 기록이 자동 완성으로 표시된다.

### FavoritePlace 생성

1. 사용자가 장소를 검색하거나 경로를 확인한다.
2. "즐겨찾기 추가" 버튼을 누른다.
3. Nickname을 입력한다. (예: "숙소", "공항")
4. FavoritePlace를 저장한다.

### FavoritePlace 조회

1. 사용자가 목적지 입력 화면에서 "즐겨찾기" 탭을 선택한다.
2. 저장된 FavoritePlace 목록이 표시된다.
3. 장소를 선택하면 자동으로 목적지가 설정된다.

### 외부 지도 앱 연계

**규칙 18**: "외부 지도에서 보기" 버튼을 제공한다.
**규칙 19**: 버튼을 누르면 시스템 기본 지도 앱(네이버, 구글 등)으로 경로를 전달한다.

---

**maps 도메인 완료** ✅
