# translations 도메인 모델

> 생성일: 2026-02-12
> Phase: 3 (Domain Modeler)
> 상태: ✅ 완료

---

## 📖 유비쿼터스 언어 (용어 정의)

> 이 도메인에서 사용하는 전용 용어들

### 핵심 용어

| 용어 | 정의 | 예시 |
|------|------|------|
| 번역 (Translation) | 사용자가 요청한 번역 기록 | 한 번의 번역 요청과 결과 |
| 식별자 (ID) | 번역 기록을 고유하게 구분하는 값 | "t_abc123" |
| 사용자 ID (UserID) | 이 번역을 요청한 사용자의 식별자 | "u_123abc" |
| 원문 (SourceText) | 번역 전 원본 텍스트 | "안녕하세요" |
| 번역문 (TargetText) | 번역된 결과 텍스트 | "Hello" |
| 음성 파일 (AudioFileUrl) | 녹음된 음성 파일의 저장 경로 (Cloud Storage) | "https://storage.../audio_123.wav" |
| 생성 시각 (CreatedAt) | 번역이 생성된 날짜와 시간 | "2026-02-12 14:30:00" |
| 미션 ID (MissionID) | 이 번역이 속한 미션의 식별자 (선택) | "m_456def" 또는 null |

---

## 📐 관계 규칙

> 이 도메인의 엔티티들이 어떻게 연결되는지 서술형으로 정의

### 번역과 사용자

**규칙 1**: 번역은 반드시 한 명의 사용자에게 속한다.
**규칙 2**: 사용자는 여러 개의 번역 기록을 가질 수 있다.
**규칙 3**: 사용자가 탈퇴하면, 번역 기록은 유지되지만 사용자는 익명으로 표시된다.

### 번역과 미션

**규칙 4**: 번역은 미션에 속할 수도 있고, 독립적일 수도 있다. (MissionID는 선택)
**규칙 5**: 한 미션은 여러 개의 번역을 포함할 수 있다.
**규칙 6**: 미션이 종료되어도 번역 기록은 유지된다.

---

## 🔒 제약 조건

> 비즈니스 규칙과 제약사항

### 필수 필드

- **ID**: 시스템이 자동으로 생성
- **UserID**: 번역을 요청한 사용자 (필수)
- **SourceText**: 원문 텍스트 (필수)
- **TargetText**: 번역된 텍스트 (필수)
- **CreatedAt**: 생성 시각 (자동)

### 선택 필드

- **AudioFileUrl**: 음성 번역인 경우에만 저장
- **MissionID**: 미션 중 번역인 경우에만 설정

### 저장 정책

**규칙 7**: 모든 번역 기록은 영구 저장된다.
**규칙 8**: 음성 파일은 Cloud Storage에 저장하고 URL만 DB에 보관한다.
**규칙 9**: STT/TTS 실패 시 재시도는 사용자가 수동으로 진행한다.

---

## 🎯 생명주기

### 생성

#### 텍스트 번역
1. 사용자가 텍스트를 입력한다.
2. 시스템은 번역 API를 호출한다.
3. 번역 결과를 Translation으로 저장한다. (SourceText, TargetText, UserID)

#### 음성 번역
1. 사용자가 마이크를 길게 눌러 음성을 녹음한다. (PTT 방식)
2. 시스템은 STT API를 호출하여 음성을 텍스트로 변환한다.
3. 변환된 텍스트를 번역 API로 번역한다.
4. 음성 파일을 Cloud Storage에 업로드하고 URL을 받는다.
5. Translation을 저장한다. (SourceText, TargetText, AudioFileUrl, UserID)

### 조회

1. 사용자는 자신의 번역 기록 목록을 볼 수 있다.
2. 최신 순으로 정렬되어 표시된다.
3. 미션별로 필터링할 수 있다.

### 수정

**규칙 10**: 번역 기록은 수정할 수 없다. (Immutable)

### 삭제

**규칙 11**: 번역 기록은 사용자가 직접 삭제할 수 없다.
**규칙 12**: 사용자 탈퇴 시에도 번역 기록은 익명화되어 보관된다.

---

**translations 도메인 완료** ✅
